
---
weight: 30
bookFlatSection: true
title: "ุจุฑุฑุณ ุณุงูุณูุฑ ุฏุฑ ุงุฑุชุจุงุท ุจุง ุณุฑูุฑ ุฏุฑ ูุงูโ ฺฉุงุฑุจุฑุฏ"
description: "ุจุฑุฑุณ ูุฌูุฏ ุณุงูุณูุฑ ู ุง ุงูฺฉุงู ุฏุณุชุฑุณ ุจู ุณุฑูุฑ ุฏุฑ ูุงู  ฺฉุงุฑุจุฑุฏ. ูุนูุง ูุงฺฏ ูุง curl ู ุชุดุฎุต ุชุญุฑู ุงุฒ ููุชุฑ"
tags: ["ุณุงูุณูุฑ", "Application", "RST injection", "null route", "ููุชุฑ", "ููุชุฑูุช", "curl", "ุตูุญูโ ูพููุฏูุง", "HTTP", "HTTPS", "Application layer", "ุงูุชุฑูุช", "ุชุญุฑู", "ุฎุทุง 403", "ุฎุทุง 503", "ูุงู  ฺฉุงุฑุจุฑุฏ", "non-transparent proxy", "Host name blocking", "ุจุฑุฑุณ ุณุงูุณูุฑ ุงูุชุฑูุช", "ุณุงูุณูุฑ ุงูุชุฑูุช"]
images:
- "/images/docs/measure-internet-censorship/Application/HTTPS-curl-exampledotcom-with-dnsgoogle-ip.png"
---

# ุจุฑุฑุณ ุณุงูุณูุฑ ุฏุฑ ุงุฑุชุจุงุท ุฏุฑ ูุงู  ฺฉุงุฑุจุฑุฏ

ุฏุฑ ุงุฑุชุจุงุท ุนุงุฏุ ุณููู ูุฑุญูู ุงุฒ ุจุงุฒุฏุฏ ฺฉ ุณุงุช ู ุง ุงุณุชูุงุฏู ุงุฒ ุณุฑูุณุ ุงุฑุชุจุงุท ุจุง ุจุฑูุงูู  ูุตุจ ุดุฏู ุฏุฑ ุณุฑูุฑ ุงุณุช. ุจู ุนููุงู ูุซุงู Apacheุ IISุ ู ุง ูุฑ ุณุฑูุณ ุณุงุฏู  ุฏฺฏุฑ.

ุจูุชุฑู ุงุจุฒุงุฑ ุจุฑุฑุณ ุงุฑุชุจุงุท ุจุง ูพุฑูุชฺฉู ูุง HTTPุ HTTPSุ MQTT ู FTP ู ุบุฑูุ [curl](https://curl.se/download.html) ุงุณุช ฺฉู ุงฺฉุซุฑ ุณุณุชู ุนุงูู ูุง ุฑุง ูพุดุชุจุงู ู ฺฉูุฏ.

ุจุฑุง ุจุฑุฑุณ ุฑูุด ูุง ฺฉู ฺฉ ุณุงุช ุฏุฑ ูุงู  ุจุงูุงุชุฑ ุงุฒ IP ูุณุฏูุฏ ุดุฏูุ ุงููู ูุฏู ุจุฑุฑุณ ุงุฑุชุจุงุท HTTP ุงุณุช. 
ุงูุง ุชูุฌู ุจู ุงู ูฺฉุชู ููู ุงุณุช ฺฉู ุฏุฑ ุงู ุจุฑุฑุณ ูุฒ ุจุงุฏ ุงุฒ IP ุงุตู ุงุณุชูุงุฏู ฺฉููุ ูู ฺุฒ ฺฉู ุณุณุชู ุณุงูุณูุฑ ุจู ูุง ู ุฏูุฏ.


## ุงุฑุชุจุงุท HTTP

ุฏุฑ ุงู ุณุทุญ ูุง ู ุฎูุงูู ฺฉู DNS Hijacking ุฏุฑ ุชุณุช ูุง ุฏุฎู ูุจุงุดุฏ ู ุฏุฑ ูุฏู ุงูู ููุท ู ุฎูุงูู ุจุจูู ฺฉู ุงฺฏุฑ ุงุฒ IP  ุฏุฑุณุช ุงุณุชูุงุฏู ฺฉููุ ุจุงุฒ ูู ุงุฑุชุจุงุท HTTP ุณุงูุณูุฑ ู ุดูุฏุ : 
<div dir="ltr">

`> .\curl -v --doh-url "https://mozilla.cloudflare-dns.com/dns-query" http://twitter.com/`
<br/>

![HTTP curl twitter with doh](/images/docs/measure-internet-censorship/Application/HTTP-curl-twitter-with-doh.png)
</div>

(ุชุตูุฑ ุงุฒ ุงูุชูุง ูุงฺฏ -- ุชุณุช ุดุฏู ุฏุฑ ููุฏูุฒ)

ุฏุฑ ุฎุท ุงูู ู ุจูุฏ ฺฉู ุฏุฑุฎูุงุณุช DoH ุจู ุฏุฑุณุช ฺฉุงูู ุดุฏ. ุฏุฑ ูุชุฌู IP  ุฏุฑุงูุช ุดุฏู ุฏุฑุณุช ุงุณุช.

ุฏุฑ ุงุฏุงููุ ุจู ุณุงุช ุชูุชุฑ ุจุง ุขุฏุฑุณ ุฏุฑุงูุช ุดุฏูุ ุฏุฑุฎูุงุณุช ูุฑุณุชุงุฏู ุดุฏ ู ฺูู ุงุฑุชุจุงุท HTTP ุงุณุชุ ุนู ุฑูุฒูฺฏุงุฑ ูุณุช ู ุจู ุฑุงุญุช ุชูุณุท ุดุฎุต ูุงุดูุงุณ ูุงุจู ุฏุณุชฺฉุงุฑ ุงุณุชุ ุฎุทุง 403 ุฏุฑ Header ู iframe ุง ฺฉู ุตูุญู  ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงู ุฑุง ููุงุด ุฎูุงูุฏ ุฏุงุฏุ ุฏุฑุงูุช ุดุฏ.

ุจุฑุง ุขุฒูุงุด ูุดุงุจูุ ุงฺฏุฑ ูุตุฏ ูุตู ุดุฏู ุจู ฺฉ IP  ุฎุงุต ุฏุงุฑูุ ู ุชูุงูู ุจู ุงู ุตูุฑุช ุงุฒ curl ุงุณุชูุงุฏู ฺฉูู:

<div dir="ltr">

`> .\curl -v --resolve twitter.com:80:104.244.42.193 http://twitter.com/`
<br/>

![HTTP curl twitter with resolve cache ip](/images/docs/measure-internet-censorship/Application/HTTP-curl-twitter-with-resolve-cache-ip.png)
</div>

ููุฏุงุฑ 80 ุจู ูุนูุง Port ุง ุงุณุช ฺฉู ูุตุฏ ูุตู ุดุฏู ุจู ุขู ุฑุง ุฏุงุฑู.

`--resolve` ุจุฑุง ูุฑุงุฑ ุฏุงุฏู ฺฉ IP ุฏุฑ DNS cache ูููุช curl ุงุณุช.

ุญุงู ุณูุงู ฺฉู ูพุด ู ุขุฏ ุงู ุงุณุช ฺฉู ุขุง ุงู ุณุงูุณูุฑุ ุจุฑ ูุจูุง ููุฏุงุฑ Host ุฏุฑ header ุงุณุช ู ุง ุจุฑ ูุจูุง ูุญุชูุง ุฏุฑุฎูุงุณุชุ ู ุง ูุฑ ุฏูุ

ุจุฑุง ุจุฑุฑุณุ ู ุชูุงูู ุงุฒ ุขุฏุฑุณ ฺฉู ู ุฏุงูู ฺฉู ุณุงูุณูุฑ ูุณุช ุงุณุชูุงุฏู ฺฉูู. ูุงููุฏ `example.com` :
<div dir="ltr">

`> .\curl -v http://example.com`
<br/>

![HTTP curl exampledotcom](/images/docs/measure-internet-censorship/Application/HTTP-curl-exampledotcom.png)
</div>

ุฏุฑ ุงูุฌุง ู ุจูู ฺฉู HTTP 200 OK ุฏุฑุงูุช ุดุฏู ู ููุฏุงุฑ title ุจุฑุงุจุฑ ุจุง ููุฏุงุฑ ุงุณุช ฺฉู ุจุง ุงูุชุฑูุช ุจุฏูู ุณุงูุณูุฑ ุจู ุฏุณุช ู ุขูุฑู.
 ุงู ุจุฏุงู ูุนูุงุณุช ฺฉู ุฏุฑ ุงู ุดุจฺฉู ุงุฑุชุจุงุท ุจุง ุงู ุฏุงููู ู IP ุณุงูุณูุฑ ูู ุดูุฏ.

ุญุงู ฺฉู ุงุฒ ูุณุฏูุฏ ูุจูุฏู ุขู ูุทูุฆู ูุณุชูุ ู ุชูุงูู ุงุฒ ุงู IP ุจุฑุง ุขุฒูุงุด ุงุณุชูุงุฏู ฺฉูู. 
ุฏุฑ curlุ ุนูุงูู ุจุฑ `--connect-to` ู `--resolve` ู ุชูุงูู ุงุฒ `-H` ุง `--header` ูุฒ ุงุณุชูุงุฏู ฺฉูู. 
ุจู ุงู ูุนูุง ฺฉู ูุง ูุตุฏ ุงุถุงูู ฺฉุฑุฏู ู ุง ุจุงุฒ ููุณ ฺฉ header ุฏุฑ HTTP ุฏุงุฑู. ุจู ุงู ุตูุฑุช:
<div dir="ltr">

`> .\curl -v -H 'Host: twitter.com' http://93.184.216.34`
<br/>

![HTTP curl twitter with example.com ip.png](/images/docs/measure-internet-censorship/Application/HTTP-curl-twitter-with-exampledotcom-ip.png)
</div>

ุฏุฑ ุงูุฌุง ุขุฏุฑุณ ุชูุชุฑ ุฏุฑ header ุจู ุนููุงู Host ุงูุชุฎุงุจ ุดุฏ ุงูุง ุฎุทุง 503 ุฏุฑุงูุช ฺฉุฑุฏู. 

ุฏุฑุฎูุงุณุช ูุดุงุจู ุฑุง ุงุฒ ุทุฑู ุณุฑูุฑ ุฎุงุฑุฌ ุงูุฌุงู ู ุฏูู ุชุง ูุงฺฉูุด ุณุฑูุฑ ุฑุง ูุณุจุช ุจู ุงู ุฏุฑุฎูุงุณุช ุจุจูู ู ูุทูุฆู ุดูู ฺฉู ุงู ุฎุทุงุ ุฎุทุง ูุฑุจูุท ุจู ุณุฑูุฑ ูุณุช:
<div dir="ltr">

![HTTP germany curl twitter with example.com ip](/images/docs/measure-internet-censorship/Application/HTTP-germany-curl-twitter-with-exampledotcom-ip.png)
</div>

ููุงูุทูุฑ ฺฉู ุงูุชุธุงุฑ ู ุฑูุชุ ุงู ุฎุทุง ุฎุงุฑุฌ ุงุฒ ุณุณุชู ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงู ูุดุงูุฏู ูุดุฏู ุงุณุช.

ุงู ุฎุทุง ุงุณุช ฺฉู ุงุฒ ุณูุช ุณุณุชู ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงูุ ุจู ุฏูู ูุงุชูุงู ุฏุฑ ุชุญูู ุจู ูููุน ุฏุฑุฎูุงุณุช ุจุงุฒ ู ฺฏุฑุฏุงูุฏ. 
[ุฏุฑ ุงูุฌุง ู ุชูุงูุฏ ุจุจูุฏ ฺฉู ุฏุฑ ฺฉ ุชุณุช ฺฉุงูู ุชูุณุท OONI-probe ุชุนุฏุงุฏ 329 ุขุฏุฑุณ ุงู ุฎุทุง ุฑุง ุฏุฑุงูุช ฺฉุฑุฏูุฏ](https://github.com/net4people/bbs/issues/42). ุญุฏูุฏ 15ูช ุงุฒ ฺฉู ูุณุช (ุดุงูู ุงฺฉุซุฑุช ูพุฑูุชฺฉู HTTPS).

ุญุงู ุจุฑุง ุจุฑุฑุณ ุฏูู ุฒูุงู ูุงฺฉูุด `--trace-time` ุฑุง ุงุถุงูู ู ฺฉูู:
<div dir="ltr">

`> .\curl -v --trace-time -H 'Host: twitter.com' http://93.184.216.34`
<br/>

![HTTP curl trace time twitter with example.com ip repeat](/images/docs/measure-internet-censorship/Application/HTTP-curl-trace-time-twitter-with-exampledotcom-ip-repeat.png)
</div>

ุฒูุงู ูพุงุณุฎฺฏู ุจุง ุฎุทุง 503ุ ุฏููุง 30 ุซุงูู ุชูุธู ุดุฏู ุงุณุช. 
ฺูุฏ ุจุงุฑ ุงู ุชุณุช ุฑุง ุชฺฉุฑุงุฑ ู ฺฉูู ู ุจุนุฏ ุงุฒ ฺฏุฐุดุช ฺูุฏ ุฏููู ุงุฒ ุฏุฑุฎูุงุณุช ุงูููุ ุณุณุชู ุณุงูุณูุฑ ุฌูุงุจ ูุนููู ุฎูุฏ ุฑุง ุจุฑุง ุณุงูุณูุฑุ ุงุฑุณุงู ู ฺฉูุฏ:
<div dir="ltr">

![HTTP curl trace time twitter with example.com ip repeat](/images/docs/measure-internet-censorship/Application/HTTP-curl-trace-time-twitter-with-exampledotcom-ip-repeat.png)
</div>


ุญุงู ุขุฒูุงุด ู ฺฉูู ฺฉู ุณุณุชู ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงู ูุณุจุช ุจู ุงุฑุชุจุงุท ุจุง IP  ุชูุชุฑุ ุงูุง ุฏุงููู  `example.com` ุฏุฑ header ฺู ูุงฺฉูุด ูุดุงู ู ุฏูุฏ:

<div dir="ltr">

`> .\curl -v -H 'Host: example.com' http://104.244.42.193/`
<br/>

![HTTP curl example.com with twitter ip](/images/docs/measure-internet-censorship/Application/HTTP-curl-exampledotcom-with-twitter-ip.png)
</div>

ุฌูุงุจ ุชุนุฌุจ ุจุฑุงูฺฏุฒ ุฏุฑุงูุช ุดุฏู ุงุณุช. 
ุฏุฑ ุญุงูุช ุนุงุฏ ุดูุง ูู ุชูุงูุฏ ุงุฒ IP ฺฉ ุณุงุช ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏ ู ุฌูุงุจ ฺฉุณุงู ุจฺฏุฑุฏ. 
ูฺฏุฑ ุงูฺฉู ูุฑ ุฏู ุจุฑ ุฑู ฺฉ ูุงุณุช ุงุดุชุฑุงฺฉ ุจุงุดูุฏ ู ุง ูุฑ ุฏู ุงุฒ CDN ุฎุงุต ุงุณุชูุงุฏู ฺฉููุฏ ฺฉู ุงุฒ domain-fronting ูพุดุชุจุงู ู ฺฉูุฏ. 

ุจุฑุง ุงุทููุงู ุฏูุจุงุฑู ุงุฒ ุณุฑูุฑ ุฎุงุฑุฌ ููู ุฏุฑุฎูุงุณุช ุฑุง ุชฺฉุฑุงุฑ ู ฺฉูู:
<div dir="ltr">

![HTTP germany curl example.com with twitter ip](/images/docs/measure-internet-censorship/Application/HTTP-germany-curl-exampledotcom-with-twitter-ip.png)
</div>

ุฌูุงุจ ูุชูุงูุช ุงุณุช. 
ุฏุฑ ูุชุฌูุ ูพุงุณุฎ ูุจู ุงุญุชูุงูุง ุจู ุฏูู ูุฌูุฏ ุณุณุชู Cache ุฏุฑ ุงูุชุฑูุช ุขู ุดุจฺฉู ุงุณุช.
ุฏุฑ ุจุฎุด ยซูุงู  ุดุจฺฉู ู ุงูุชูุงูยปุ ูุดุงู ุฏุงุฏู ุดุฏ ฺฉู ุฏุฑ ุฏุณุชูุฑ traceroute ุจุง Port `80` ู ุจู ุตูุฑุช TCPุ ุจุนุฏ ุงุฒ ููุท ณ Hopุ ุจุง ุชุงุฎุฑ ุจุณุงุฑ ูพุงูุ ุงุฒ ุณุฑูุฑ ููุตุฏ ุฌูุงุจ ุฏุฑุงูุช ู ฺฉุฑุฏู. 
ุงู ุณุณุชู ุงุญุชูุงูุง ููุท ุจุฑ ูุจูุง ููุฏุงุฑ Host ฺฉุงุฑ ู ฺฉูุฏ ู IP ุฑุง ุจุฑุง ุฏุฑุฎูุงุณุช ููุง ูุฏ ูุธุฑ ูุฑุงุฑ ูู ุฏูุฏ. 

ฺฉ ุชุณุช ุฏฺฏุฑ ุงูุฌุงู ู ุฏูู. ุจุง IP  ุชูฺฏุฑุงู ู ุฏุงููู  iran.ir :
<div dir="ltr">

`> .\curl -v -H 'Host: iran.ir' http://149.154.167.99/`
<br/>

![HTTP curl iran.ir with telegram ip](/images/docs/measure-internet-censorship/Application/HTTP-curl-irandotir-with-telegram-ip.png)
</div>

ุฏุฑ ูุชุฌูุ IP ุงฺฏุฑ ูุณุฏูุฏ ุจุงุดุฏุ ุงุฒ ุขู ุฌููฺฏุฑ ู ุดูุฏุ ุชูุงูุช ูุฌูุฏ ูุฏุงุฑุฏ. 
ุจู ุฌุง ุชูฺฏุฑุงู ุงุฒ IP  Wikipedia ุงุณุชูุงุฏู ู ฺฉูู:
<div dir="ltr">

`> .\curl -v -H 'Host: iran.ir' http://91.198.174.192/`
<br/>

![HTTP curl iran.ir with wikipedia ip](/images/docs/measure-internet-censorship/Application/HTTP-curl-irandotir-with-wikipedia-ip.png)
</div>

ุฏูุจุงุฑู ุฎุทุง 503 ุฏุฑุงูุช ฺฉุฑุฏู ฺฉู ุจู ูุธุฑ ุณุณุชู Cache ุฌูููุฑ ุงุณูุงู ุจุฑุง ุขุฏุฑุณ iran.ir ุขูุงุฏู ูุจูุฏ.

ุงู ุจุงุฑ ุจู ุฌุง ุขุฏุฑุณ iran.ir ุงุฒ google.com ุงุณุชูุงุฏู ู ฺฉูู ฺฉู ู ุฏุงูู ฺฉู ุจู ุชุงุฒฺฏ ุญุฏุงูู ฺฉ ุจุงุฑ ุชูุณุท ูุฑุฏู ุฏุฑุฎูุงุณุช ุฏุงุฏู ุดุฏู ุงุณุช:
<div dir="ltr">

`> .\curl -v -H 'Host: google.com' http://91.198.174.192/`
<br/>

![HTTP curl google.com with wikipedia ip](/images/docs/measure-internet-censorship/Application/HTTP-curl-googledotcom-with-wikipedia-ip.png)
</div>

ููุงูุทูุฑ ฺฉู ุงูุชุธุงุฑ ู ุฑูุชุ ุฌูุงุจ ุฏุงุฏู ุดุฏ. ููู ุฏุฑุฎูุงุณุช ุฑุง ุฏูุจุงุฑู ุงุฒ ุณุฑูุฑ ุฎุงุฑุฌ ุงูุฌุงู ู ุฏูู:
<div dir="ltr">

![HTTP germany curl google.com with wikipedia ip](/images/docs/measure-internet-censorship/Application/HTTP-germany-curl-googledotcom-with-wikipedia-ip.png)
</div>

ู ุจูู ฺฉู ุฌูุงุจ ูุชูุงูุช ุงุณุช. 
ุฏูุจุงุฑู ููู ุฏุฑุฎูุงุณุช ุฑุง ุงุฒ ุงุฑุงู ุงูุฌุงู ู ุฏูู ู www. ุฑุง ุงุถุงูู ู ฺฉูู:
<div dir="ltr">

`> .\curl -v -H 'Host: www.google.com' http://91.198.174.192/ `
<br/>

![HTTP curl www.google.com with wikipedia ip](/images/docs/measure-internet-censorship/Application/HTTP-curl-wwwgoogledotcom-with-wikipedia-ip.png)
</div>

ูุญุชูุง ุตูุญู  ฺฏูฺฏู ุงุฒ ุทุฑู IP  ูฺฉโูพุฏุง ุจู ุตูุฑุช ฺฉุงูู ุฏุฑุงูุช ุดุฏู ุงุณุช. ุจุง ุชูุฌู ุจู ุณุงุนุช ุฏุฑุฎูุงุณุชุ ุจู ูุธุฑ ุฏุฑุฎูุงุณุช ุฏุฑ ููุงู ูุญุธู ุงูุฌุงู ุดุฏู ู ุฏุฑ ูุชุฌู ุงู ฺฉ middle box ุฏุฑ ุณุณุชู ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงู ุงุณุช.

ุฏุฑ ุงู ุฑุงุจุทูุ ุฏุฑ ฺฏุฐุดุชู [ฺฏุฒุงุฑุด ุชูุณุท Citizenlab](https://citizenlab.ca/2018/04/planet-netsweeper/) ููุชุดุฑ ุดุฏู ฺฉู ุฑูฺฉุฑุฏ ุณุณุชู ุณุงูุณูุฑ ุง ฺฉู ุชูุณุท ุดุฑฺฉุช ฺฉุงูุงุฏุง Netsweeper ุณุงุฎุชู ุดุฏู ุฑุง ุจู ุตูุฑุช ุฒุฑ ุจู ุชุตูุฑ ฺฉุดุฏู ุงุณุช:

<div dir="ltr">

![Citizenlab planet netsweeper](/images/docs/measure-internet-censorship/Application/Citizenlab-planet-netsweeper.png)
</div>


## ุงุฑุชุจุงุท HTTPS

ููุงููุฏ HTTP ูุง ูุจุงุฏ ุณุงูุณูุฑ ุงุฒ ุทุฑู DNS hijacking ุฑุง ุฏุฑ ุงู ุณุทุญ ุงุฒ ุขุฒูุงุด ูุง ุฏุฎู ฺฉูู. 
ุจุฑุง ุงู ฺฉุงุฑุ ุงุฒ ููุงู ุฑูุด ูุง ุชูุถุญ ุฏุงุฏู ุดุฏู ุฏุฑ ุงุฑุชุจุงุท HTTP ูุชูุงูู ุงุณุชูุงุฏู ฺฉูู. 
ุจุฌุฒ ุงูฺฉู ุชูุงู header ูุง ู ุขุฏุฑุณ ูุง ุฑูุฒูฺฏุงุฑ ู ุดููุฏ ู ุฏุฑ ูุชุฌู ุชูุณุท ุณุณุชู ุณุงูุณูุฑ ูุงุจู ูุดุงูุฏู ูุณุชูุฏ ุชุง ูุณุจุช ุจู ุขููุง ุณุงูุณูุฑ ุดุฏู ุง ูุดุฏู ุชุตูู ฺฏุฑ ุดูุฏ.
ุงูุง ููุงุฑุฏ ุฌุฏุฏ ูุฌูุฏ ุฏุงุฑูุฏ ฺฉู ุณุณุชู ุณุงูุณูุฑ ูุณุจุช ุจู ุขููุง ุชุตูู ฺฏุฑ ฺฉูุฏ ู ุฏุฑ ุตูุฑุช ุชูุงูุ ุงุฒ ุงุฏุงูู  ุงุฑุชุจุงุท ุฌููฺฏุฑ ฺฉูุฏ.

ุงููู ููุฑุฏ ู ุชูุงูุฏ [SNI](https://en.wikipedia.org/wiki/Server_Name_Indication) ุจุงุดุฏ. 
ุจุฎุด ุฏุฑ ุงุฑุชุจุงุท TLS ฺฉู ุจู ุณุฑูุฑ ุงู ุงุทูุงุน ุฑุง ู ุฏูุฏ ฺฉู ฺฉุงุฑุจุฑ ูุตุฏ ูุตู ุดุฏู ุจู ฺู host ุง ุฏุงุฑุฏ.

SNI ุฏุฑ Client Hello ูุฑุงุฑ ุฏุงุฑุฏ. 
ุงูุง ุจุนุฏ ุงุฒ ุงู packetุ ุณุฑูุฑ Server Hello ุฑุง ุงุฑุณุงู ู ฺฉูุฏ ฺฉู ุงฺฏุฑ ุฒุฑ ูุณุฎู  TLSv1.3 ุจุงุดุฏุ ูุญุชูุง ัerfiticate ุจู ุตูุฑุช plain text ุงุฑุณุงู ู ุดูุฏ. 
ุฏุฑ ฺฏุฐุดุชู ุงุฒ ุงู ุทุฑู ุดูุงุณุง ูุญุชูุง ุฑูุฒูฺฏุงุฑ ูุดุฏู ุฏุฑ ุงู packetุ [ุงุฑุชุจุงุท ุณุฑูุฑูุง ุงูุณุชุงฺฏุฑุงู ุฏุฑ ุงุฑุงู ูุณุฏูุฏ ุดุฏู ุจูุฏ](https://ooni.org/post/2018-iran-protests-pt2/). (ุชููุง ฺฉุดูุฑ ฺฉู ุชุงฺฉููู ูุดุงูุฏู ุดุฏู ฺฉู ฺูู ฺฉุงุฑ ุงูุฌุงู ุฏุงุฏู ุงุณุช)

ุงูุง ุจุง ูพุดุฑูุช ุชฺฉููููฺ ุงู ุถุนู ุฏฺฏุฑ ุฏุฑ ูุณุฎู ูุง ุฌุฏุฏ ูุฌูุฏ ูุฏุงุฑุฏ. 
ุงูุจุชู ุจุฑุง ุญู ูุดฺฉู SNI ูุฒ ุงุณุชุงูุฏุงุฑุฏ ุฏุฑ ุญุงู ููุดุชู ุดุฏู ุงุณุช ฺฉู extension ูุง ุจุง ุงุทูุงุนุงุช ุญุณุงุณ ุฏุฑ Client Hello ุจู ุตูุฑุช ุฑูุฒูฺฏุงุฑ ุดุฏู ุฏุฑ [extension ุฌุฏุฏ ุจู ูุงู ECH](https://blog.cloudflare.com/encrypted-client-hello/) ูุฑุงุฑ ุจฺฏุฑูุฏ. 

ุฏุฑ ุญุงู ุญุงุถุฑ ุงุฑุชุจุงุท HTTPS ุจู ฺูุฏ ุตูุฑุช ูุณุฏูุฏ ู ุดููุฏ:

- ุงุฒ ุทุฑู SNI
- ุงุฒ ุทุฑู fingerprint ุฏุฑ TLS
- ูุณุฏูุฏ ุณุงุฒ TLS ุจู ุตูุฑุช ฺฉู
- ูุณุฏูุฏ ุณุงุฒ ุงุฑุชุจุงุท ุจู ุตูุฑุช random

ุฏุฑ ููุฑุฏ ูุณุฏูุฏ ุณุงุฒ ูุง ุงุฒ ุทุฑู fingerprint ู ูุณุฏูุฏ ฺฉุฑุฏู ูุง randomุ ุฏุฑ ุจุฎุด ูุง ูุฌุฒุง ุชูุถุญ ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.
ุฏุฑ ุงุฏุงูู ุจู ุฏู ููุฑุฏ ุณุงุฏู ุชุฑ ู ูพุฑุฏุงุฒู.

### ุจุฑุฑุณ ุณุงุฏู  SNI ู TLS 

ุฏุณุชุฑุณ ุจู ุชูุชุฑ ุฑุง ุจุง ุชูุธู ุฏุณุช timeout ุจู ูุฏุช 30 ุซุงูู ููุฑุฏ ุขุฒูุงุด ูุฑุงุฑ ู ุฏูู:

<div dir="ltr">

`$ curl -v -m 30 --doh-url https://mozilla.cloudflare-dns.com/dns-query https://twitter.com/`
<br/>

![HTTPS curl twitter with doh and timeout30](/images/docs/measure-internet-censorship/Application/HTTPS-curl-twitter-with-doh-timeout30.png)
</div>


ุฏุฑ ุงูุฌุง ู ุจูู ฺฉู ุจุนุฏ ุงุฒ Client hello ู ุจุนุฏ ุงุฒ ฺฏุฐุดุช 30 ุซุงููุ ุจุง ูพุงู timeout ุงุฑุชุจุงุท ุจุณุชู ุดุฏู ุงุณุช. ุงู ุจู ุงู ุฏูู ุงุณุช ฺฉู ุฏุฑ ุงู ุงุชูุงู ุงุญุชูุงูุง ุจู ุฏูู SNI ุงุณุช ุงูุง ุจุฑุง ุงุทููุงู ุจุงุฏ ุจุฑุฑุณ ุจุดุชุฑ ุงูุฌุงู ุฏูู.

ุจุฑุง ุงูฺฉู ุจุจูู ฺฉู ุขุง ุณุณุชู ุณุงูุณูุฑ ุจู ูุงู ุชูุชุฑ ุฏุฑ SNI ุญุณุงุณ ุงุณุช ุง ูุณุฆูู  ุฏฺฏุฑุ ุจุงุฏ ุงุฒ IP ุณุงุช ฺฉู ู ุฏุงูู ููุชุฑ ูุณุช ุงุณุชูุงุฏู ฺฉูู ู ุงูุง ุงุฒ ุขุฏุฑุณ ุชูุชุฑ ุฏุฑ SNI ุงุณุชูุงุฏู ฺฉูู. ูุงููุฏ ุฏุณุชูุฑ ุฒุฑ ฺฉู ุงุฒ IP  ุณุงุช example.org ุงุณุชูุงุฏู ฺฉุฑุฏู:

<div dir="ltr">

`$ curl -v -m30 --resolve 'twitter.com:443:93.184.216.34' https://twitter.com/`
<br/>

![HTTPS curl twitter with resolve cache example.com ip timeout30](/images/docs/measure-internet-censorship/Application/HTTPS-curl-twitter-with-exampledotcom-ip-timeout30.png)
</div>

ุจู ุฏูู ุงูฺฉู ูพุงูุฏ ูุดุงุจู ุฏุงุดุชูุ ุจู ุงู ูุชุฌู ู ุฑุณู ฺฉู ุงู ูุณุฏูุฏ ุณุงุฒ ุงุฒ ุทุฑู ุดูุงุณุง ุขุฏุฑุณ twitter.com ุฏุฑ ุจุฎุด SNI ุฏุฑ Client hello ุตูุฑุช ฺฏุฑูุชู ุงุณุช.

ุงูุง ุณุณุชู ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงู ฺฏุงู ุฑูุชุงุฑ ูุชูุงูุช ูุฒ ุฏุงุฑุฏ. 

ุจุฑุง ูุดุงู ุฏุงุฏู ููููู ูุง ุจุดุชุฑุ ุงู ุจุงุฑ ุขุฏุฑุณ dns.google ุฑุง ุงูุชุญุงู ู ฺฉูู:
<div dir="ltr">

`$ curl -v -m30 https://dns.google/`
<br/>

![HTTPS curl dns.google](/images/docs/measure-internet-censorship/Application/HTTPS-curl-dnsgoogle.png)
</div>

ููุงููุฏ ูุจู ุงุฑุชุจุงุท ุจุนุฏ ุงุฒ Client hello ูุงุฑุฏ ุณุงู ฺุงูู ุดุฏู ุงุณุช. 

ุฏุฑ ุงุฏุงูู ุชุณุช ูุณุฏูุฏ ุจูุฏู SNI ุฑุง ุงูุฌุงู ู ุฏูู ู ุงุฒ IP  ุณุงุช example.org ุงุณุชูุงุฏู ู ฺฉูู:
<div dir="ltr">

`$ curl -v -m30 --resolve dns.google:443:93.184.216.34  https://dns.google/`
<br/>

![HTTPS curl dns.google with example.com ip](/images/docs/measure-internet-censorship/Application/HTTPS-curl-dnsgoogle-with-exampledotcom-ip.png)
</div>

ุฏุฑ ุงุฌุง ู ุจูู ฺฉู TLS handshake ุจู ุตูุฑุช ฺฉุงูู ุงูุฌุงู ุดุฏู ุงุณุช. 
(ุฎุทุง ุจู ุฎุงุทุฑ ููุณุงู ูุจูุฏู Certificate ุงุฑุณุงู ุงุฒ ุณุฑูุฑ ู ุขุฏุฑุณ ุฏุฑุฎูุงุณุช ุงุณุช)

ุจูุงุจุฑุงู ูุณุฏูุฏ ุณุงุฒ ูู ุชูุงูุฏ ุตุฑูุง ุจู ุฎุงุทุฑ ุขุฏุฑุณ dns.google ุจุงุดุฏ. 
ุณูุงู ุงู ุงุณุช: 
ุขุง ุงุฒ ูุฑ ุงุฑุชุจุงุท TLS ุจู ุณูุช ุขุฏุฑุณ 8.8.4.4 ุฌููฺฏุฑ ู ุดูุฏุ 

ุจุฑุง ูพุงุณุฎ ุจู ุงู ุณูุงูุ ุงู ุจุงุฑ ุงุฒ ุขุฏุฑุณ IP  dns.google ุงุณุชูุงุฏู ู ฺฉูู ุงูุง ุงุฒ ุขุฏุฑุณ ุฏุงููู  example.com ุจุฑุง SNI ุงุณุชูุงุฏู ู ฺฉูู:
<div dir="ltr">

`$ curl -v -m30 --resolve example.com:443:8.8.4.4 https://example.com/`
<br/>

![HTTPS curl example.com with dns.google ip](/images/docs/measure-internet-censorship/Application/HTTPS-curl-exampledotcom-with-dnsgoogle-ip.png)
</div>

ุฏุฑ ุงูุฌุง ู ุจูู ฺฉู ุณุณุชู ุณุงูุณูุฑ ุฌูููุฑ ุงุณูุงู ููุท ูุณุจุช ุจู ูุฑ ุงุฑุชุจุงุท TLS ุจู ุงู IP ุญุณุงุณ ุงุณุช ู ุขุฏุฑุณ ุฏุงููู ุฑุง ููุงฺฉ ูุฑุงุฑ ูู ุฏูุฏ.

ุงูุจุชู ุงู ุฑูุชุงุฑ ุฏุฑ ููู  ุดุจฺฉู ูุง ู ุง ูุณุจุช ุจู ููู  ุขุฏุฑุณ ูุง ฺฉุณุงู ูุณุช. 
ุจู ุนููุงู ูุซุงูุ ุชุณุช ูุง ุจุงูุง ุฑุง ฺฉู ุฏุฑ ูุฎุงุจุฑุงุช (AS58224) ุงูุฌุงู ุดุฏู ุจูุฏ ุฑุง ุฏุฑ ููุฑุงู ุงูู (AS197207) ุชฺฉุฑุงุฑ ู ฺฉูู:
<div dir="ltr">

`$ curl -v -m30 --resolve dns.google:443:8.8.4.4  https://dns.google/`
<br/>

![HTTPS mci curl dns.google 8.8.4.4 ip](/images/docs/measure-internet-censorship/Application/HTTPS-mci-curl-dnsgoogle-8844-ip.jpg)

</div>

ู ุจูู ฺฉู ุจุนุฏ ุงุฒ ุจู ูพุงุงู ุฑุณุฏู TLS Handshake ุงุฑุชุจุงุท ูุงุฑุฏ ุณุงู ฺุงูู ุดุฏู ุงุณุชุ ุฒูุงู ฺฉู ุงุฑุชุจุงุท HTTP  ุดุฑูุน ู ุดูุฏ. 
ุงู ู ุชูุงูุฏ ุจู ุฏูู ุชุงุฎุฑ ุฏุฑ ูุงฺฉูุด ุณุณุชู ุณุงูุณูุฑ ุจุงุดุฏ ฺฉู ุงููู ุจุงุฑ ุงู ุฑูุชุงุฑ [ุฏุฑ ฺู ูุดุงูุฏู ุดุฏ](https://github.com/net4people/bbs/issues/43#issuecomment-673490763).

ุงูุจุชู ุฏุฑ ุงูุฌุง ุญุณุงุณุช ููุท ุจู ุขุฏุฑุณ `dns.google` ูุณุช. 
ุจู ุนููุงู ูุซุงู ุฏุฑ ุชุณุช ุจุนุฏุ ููุงููุฏ ูุจู ูพุด ู ุฑูู ู ุงุฒ IP  ุณุงุช `example.com` ุงุณุชูุงุฏู ู ฺฉูู.
ููฺูู ุจู ุฏูู ุงูฺฉู ูุณุฏูุฏ ุดุฏู ุงุฑุชุจุงุท ุจุนุฏ ุงุฒ TLS Handshake ุงุชูุงู ุงูุชุงุฏู ุจูุฏุ ุฏุฑ ุชุณุช ุจุนุฏ ุงุฒ `-k` ูุฒ ุงุณุชูุงุฏู ู ฺฉูู ุชุง ุชูุงูุช certificate ุจุง ุขุฏุฑุณ ุฏุฑุฎูุงุณุช ุฏุฑ SNIุ ุจุงุนุซ ูพุงุงู ุงูุชู ุงุฑุชุจุงุท ูุจู ุงุฒ ุดุฑูุน HTTP ูุดูุฏ.

<div dir="ltr">

`$ curl -v -m30 -k --resolve dns.google:443:93.184.216.34  https://dns.google/`
<br/>

![HTTPS mci curl dns.google with example.com ip part 1](/images/docs/measure-internet-censorship/Application/HTTPS-mci-curl-dnsgoogle-with-exampledotcom-ip-1.jpg)
<br/>

![HTTPS mci curl dns.google with example.com ip part 2](/images/docs/measure-internet-censorship/Application/HTTPS-mci-curl-dnsgoogle-with-exampledotcom-ip-2.jpg)
</div>

ุงุฑุชุจุงุท ูุณุฏูุฏ ูุดุฏู ุงุณุช.

ู ุฏุฑ ุชุณุช ุจุนุฏุ ุงุฒ IP  `dns.google` ุงุณุชูุงุฏู ู ฺฉูู ู SNI ุฑุง ุจุฑุง `example.com` ุฏุฑ ูุธุฑ ู ฺฏุฑู:
<div dir="ltr">

`$ curl -v -m30 -k --resolve example.com:443:8.8.4.4 https://example.com/`
<br/>

![HTTPS mci curl example.com with dns.google ip](/images/docs/measure-internet-censorship/Application/HTTPS-mci-curl-exampledotcom-with-dnsgoogle-ip.jpg)
</div>

ุฏุฑ ูุชุฌู ุฏุฑ ุงู ุดุจฺฉูุ ุจุนุถ ุงุฒ ุณุฑูุณ ูุง ููุท ุฏุฑ ุตูุฑุช ุง ูุณุฏูุฏ ุฎูุงููุฏ ุดุฏ ฺฉู ูู ุขุฏุฑุณ ุฏุฑ SNI ู ูู ุขุฏุฑุณ IP ุจุง rule ุชูุธู ุดุฏู ุฏุฑ ุณุณุชู ุณุงูุณูุฑ ูุทุงุจูุช ุฏุงุดุชู ุจุงุดูุฏ.
ุฏุฑ ููุฑุฏ ุงู ููุถูุน ุฏุฑ ุจุฎุด ูุณุฏูุฏ ุณุงุฒ random ุณุฑูุณ ูุง ุจุงุฒ ูู ุชูุถุญ ุฏุงุฏู ุฎูุงูุฏ ุดุฏ.

## ุชุดุฎุต ุชุญุฑู ุงุฒ ููุชุฑ

ุจุฑุง ุชุดุฎุต ุงูฺฉู ฺฉ ุงุฑุชุจุงุท ููุชุฑ ุดุฏู ุงุณุช ู ุง ุจู ุฏูู ุชุญุฑู ุงูฺฉุงู ุงุฑุชุจุงุท ุจุง ุขู ูุฌูุฏ ูุฏุงุฑุฏุ ุจุงุฏ ุงุฒ ุงุฑุชุจุงุท HTTPS ุงุณุชูุงุฏู ุดูุฏ.
ุจู ุฏูู ุงูฺฉู ุงู ุงูฺฉุงู ูุฑุงูู ู ุดูุฏ ุชุง ุงู ุจุฑุฑุณ ุงุฒ ุฏุณุชฺฉุงุฑ ุดุฏู ูุญุชูุงุด ุฏุฑ ูุณุฑ ุงุฑุชุจุงุท ุฏุฑ ุงูุงู ุจูุงูุฏ.

ููฺูู ุท ฺฉ ุณุงู ุงุฎุฑุ ุฏุฑ ุงฺฉุซุฑ ููุงุฑุฏ ุชุญุฑู ุจุฏูู ููุงุด ุฎุทุง HTTPุ ุงุฒ ุงุฑุชุจุงุท ุฌููฺฏุฑ ูุดุฏู ุงุณุช. 
ุนู ุงฺฏุฑ ุชุญุฑู ุตูุฑุช ฺฏุฑูุชู ุจุงุดุฏุ ูุง ูุนูููุง ู ุชูุงูู ุจู ุตูุฑุช ฺฉุงูู TCP handshake ู TLS handshake ุฏุงุฑู.

ุจู ุฏูู ุณุงุฏฺฏ ุชุดุฎุต ุชุญุฑู ู ูพฺุฏฺฏ ููุชุฑุ ุจูุชุฑ ุงุณุช ฺฉู ุงุฒ OONI ููุงูุทูุฑ ฺฉู ุชูุถุญ ุฏุงุฏู ุดุฏ ุงุณุชูุงุฏู ฺฉูุฏ. 
ุงูุง ุงฺฏุฑ ุจู ุตูุฑุช ุฏุณุช ู ุฎูุงูุฏ ุงู ฺฉุงุฑ ุฑุง ุงูุฌุงู ุฏูุฏุ ู ุชูุงูุฏ ุงุจุชุฏุง ฺฉ ุจุงุฑ ุขุฏุฑุณ ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุดุจฺฉู  ุฎูุฏ ุชุณุช ฺฉูุฏ ู ุงฺฏุฑ ุฎุทุง HTTP  403 ู ุง 404 ุฏุฑุงูุช ฺฉุฑุฏุฏ ู ุงูุง ููุช ุงุฒ ููุชุฑุดฺฉู ุงุณุชูุงุฏู ู ฺฉูุฏ ุฎุทุง ูุดุงุจู ุฏุฑุงูุช ูฺฉุฑุฏุฏุ ุงู ูุดุงู ู ุฏูุฏ ฺฉู ุงุฑุชุจุงุท ุจุง ุงุฑุงู ุชุญุฑู ุดุฏู ุงุณุช.

ุงูุจุชู ฺฏุงู ููฺฉู ุงุณุช ฺฉู ฺฉ ุขุฏุฑุณุ ูู ุชุญุฑู ู ูู ููุชุฑ ุดูุฏ.
ูุงููุฏ Firebase :

<blockquote class="twitter-tweet" data-lang="en" data-dnt="true" data-theme="dark"><p lang="fa" dir="rtl">ุฏุงูููโ <a href="https://t.co/dJqPfPjT8M">https://t.co/dJqPfPjT8M</a> ุงุฒ ุจุฎ ู ุจู ููุชุฑ ุดุฏุ! ๐<a href="https://twitter.com/azarijahromi?ref_src=twsrc%5Etfw">@azarijahromi</a></p>&mdash; Shecan | ุดฺฉู (@shecan_ir) <a href="https://twitter.com/shecan_ir/status/1263424522784591872?ref_src=twsrc%5Etfw">May 21, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 

